"use strict";(self.legacyJsonp=self.legacyJsonp||[]).push([["42487"],{39626(e,t,r){r.d(t,{A:function(){return C}});var n=r(157203),o=r(946368),i=["1200x","736x","474x474","236x236"],a=r(620162),u=r(460657),c=r(370714),l=r(948828),s=r(879667);function f(e){var t=e.buttonPadding,r=e.isDeleted,n=e.onUndoClick,o=(0,c.A)();return(0,s.jsx)(l.A,{children:(0,s.jsxs)(u.az,{bottom:!0,dangerouslySetInlineStyle:{__style:{backgroundColor:"var(--sema-color-background-wash-scrims-default)",backdropFilter:"blur(10px)",cursor:"default",opacity:+!!r,pointerEvents:r?"auto":"none",transition:"opacity 200ms linear"}},left:!0,padding:null!=t?t:3,position:"absolute",right:!0,rounding:400,top:!0,children:[(0,s.jsx)(u.KJ,{color:"light",children:o._('Successfully deleted', 'lens.history.deleted.message', 'Message shown when history item is deleted')}),(0,s.jsx)(u.Rp,{onTap:n,children:(0,s.jsx)(u.Wu,{color:"light",children:o._('Undo', 'lens.history.undo', 'Undo deletion button')})})]})})}var d=r(30389);function p(e){var t=e.buttonPadding,r=e.saveButtonOnly,n=e.hideSave,o=e.imageUrl,i=e.onDeleteClick,a=(0,c.A)();return(0,s.jsxs)(u.az,{alignItems:"end",bottom:!0,dangerouslySetInlineStyle:{__style:{backgroundColor:"var(--sema-color-background-wash-image-tint)"}},direction:"column",display:"flex",left:!0,padding:null!=t?t:3,position:"absolute",right:!0,rounding:400,top:!0,children:[!n&&(0,s.jsx)(d.A,{imageUrl:o,saveButtonOnly:r}),(0,s.jsx)(u.az,{marginTop:"auto",children:(0,s.jsx)(u.K0,{accessibilityLabel:a._('Delete', 'lens.history.image.delete', 'Clicking on this deletes the image from the lens history'),bgColor:"secondary",icon:"trash-can",onClick:i,size:"md"})})]})}var v=r(910623),y=r(186122),h=r(155357);function b(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=Object.create((n&&n.prototype instanceof u?n:u).prototype);return m(c,"_invoke",function(r,n,o){var i,u,c,l=0,s=o||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return i=t,u=0,c=e,d.n=r,a}};function p(r,n){for(u=r,c=n,t=0;!f&&l&&!o&&t<s.length;t++){var o,i=s[t],p=d.p,v=i[2];r>3?(o=v===n)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=r<2&&p<i[1])?(u=0,d.v=n,d.n=i[1]):p<v&&(o=r<3||i[0]>n||n>v)&&(i[4]=r,i[5]=n,d.n=v,u=0))}if(o||r>1)return a;throw f=!0,n}return function(o,s,v){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,v),u=s,c=v;(t=u<2?e:c)||!f;){i||(u?u<3?(u>1&&(d.n=-1),p(u,c)):d.n=c:d.v=c);try{if(l=2,i){if(u||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,u<2&&(u=0)}else 1===u&&(t=i.return)&&t.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=e}else if((t=(f=d.n<0)?c:r.call(n,d))!==a)break}catch(t){i=e,u=1,c=t}finally{l=1}}return{value:t,done:f}}}(r,o,i),!0),c}var a={};function u(){}function c(){}function l(){}t=Object.getPrototypeOf;var s=l.prototype=u.prototype=Object.create([][n]?t(t([][n]())):(m(t={},n,function(){return this}),t));function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,m(e,o,"GeneratorFunction")),e.prototype=Object.create(s),e}return c.prototype=l,m(s,"constructor",l),m(l,"constructor",c),c.displayName="GeneratorFunction",m(l,o,"GeneratorFunction"),m(s),m(s,o,"Generator"),m(s,n,function(){return this}),m(s,"toString",function(){return"[object Generator]"}),(b=function(){return{w:i,m:f}})()}function m(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}(m=function(e,t,r,n){function i(t,r){m(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(i("next",0),i("throw",1),i("return",2))})(e,t,r,n)}function g(e,t,r,n,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void r(e)}u.done?t(c):Promise.resolve(c).then(n,o)}function S(e){var t,r=e.buttonPadding,o=e.height,i=e.hideSave,l=e.id,d=e.imageHeight,m=e.imageWidth,S=e.isDeleted,w=e.onDeleted,j=e.onUndoDelete,_=e.src,O=e.viewParameter,P=e.viewType,A=e.width,x=(0,c.A)(),T=(0,a.Zp)(),k=(0,y.o)().logContextEvent,C=(0,v.S)(),I=C.setPreparedImage,E=C.setIsPopoverOpen,G=(0,h.A)(),U=G.hovered,B=G.onMouseEnter,D=G.onMouseLeave,z=(0,n.useCallback)((t=b().m(function e(){var t,r;return b().w(function(e){for(;;)switch(e.p=e.n){case 0:return k({aux_data:{url:_},event_type:101,view_parameter:O,view_type:P}),e.p=1,e.n=2,fetch(_);case 2:return t=e.v,e.n=3,t.blob();case 3:I({file:new File([r=e.v],"lens-history-".concat(l),{type:r.type}),src:_,apiUrl:_,width:m,height:d}),k({aux_data:{url:_},event_type:6707,view_parameter:O,view_type:P}),E(!1),T("/lens-search/"),e.n=5;break;case 4:e.p=4,e.v;case 5:return e.a(2)}},e,null,[[1,4]])}),function(){var e=this,r=arguments;return new Promise(function(n,o){var i=t.apply(e,r);function a(e){g(i,n,o,a,u,"next",e)}function u(e){g(i,n,o,a,u,"throw",e)}a(void 0)})}),[k,_,O,P,l,I,m,d,E,T]),F=(0,n.useCallback)(function(e){e.event.stopPropagation(),w(l)},[l,w]),R=(0,n.useCallback)(function(e){e.event.stopPropagation(),j(l)},[l,j]),L=(null!=A?A:m)/(null!=o?o:d);return(0,s.jsx)(u.Rp,{onTap:z,children:(0,s.jsxs)(u.az,{dangerouslySetInlineStyle:{__style:{aspectRatio:L}},onMouseEnter:B,onMouseLeave:D,overflow:"hidden",position:"relative",rounding:400,children:[(0,s.jsx)(u.n1,{height:"100%",rounding:400,width:"100%",children:(0,s.jsx)(u._V,{alt:x._('Lens history image', 'lens.history.image.alt', 'Image that was uploaded by the user to Lens History'),fit:"cover",naturalHeight:d,naturalWidth:m,src:_})}),U&&!S&&(0,s.jsx)(p,{buttonPadding:r,hideSave:i,imageUrl:_,onDeleteClick:F}),(0,s.jsx)(f,{buttonPadding:r,isDeleted:S,onUndoClick:R})]})})}var w=r(559463),j=r(891546);function _(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=Object.create((n&&n.prototype instanceof u?n:u).prototype);return O(c,"_invoke",function(r,n,o){var i,u,c,l=0,s=o||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return i=t,u=0,c=e,d.n=r,a}};function p(r,n){for(u=r,c=n,t=0;!f&&l&&!o&&t<s.length;t++){var o,i=s[t],p=d.p,v=i[2];r>3?(o=v===n)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=r<2&&p<i[1])?(u=0,d.v=n,d.n=i[1]):p<v&&(o=r<3||i[0]>n||n>v)&&(i[4]=r,i[5]=n,d.n=v,u=0))}if(o||r>1)return a;throw f=!0,n}return function(o,s,v){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,v),u=s,c=v;(t=u<2?e:c)||!f;){i||(u?u<3?(u>1&&(d.n=-1),p(u,c)):d.n=c:d.v=c);try{if(l=2,i){if(u||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,u<2&&(u=0)}else 1===u&&(t=i.return)&&t.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=e}else if((t=(f=d.n<0)?c:r.call(n,d))!==a)break}catch(t){i=e,u=1,c=t}finally{l=1}}return{value:t,done:f}}}(r,o,i),!0),c}var a={};function u(){}function c(){}function l(){}t=Object.getPrototypeOf;var s=l.prototype=u.prototype=Object.create([][n]?t(t([][n]())):(O(t={},n,function(){return this}),t));function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,O(e,o,"GeneratorFunction")),e.prototype=Object.create(s),e}return c.prototype=l,O(s,"constructor",l),O(l,"constructor",c),c.displayName="GeneratorFunction",O(l,o,"GeneratorFunction"),O(s),O(s,o,"Generator"),O(s,n,function(){return this}),O(s,"toString",function(){return"[object Generator]"}),(_=function(){return{w:i,m:f}})()}function O(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}(O=function(e,t,r,n){function i(t,r){O(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(i("next",0),i("throw",1),i("return",2))})(e,t,r,n)}function P(e,t,r,n,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void r(e)}u.done?t(c):Promise.resolve(c).then(n,o)}function A(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var x=r(799632);function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function C(e){var t,r,a,u,c,l,f,d=e.buttonPadding,p=e.height,v=e.hideSave,h=e.pageSize,b=e.viewParameter,m=e.viewType,g=e.width,O=(0,x.A)({name:"ApiResource",options:{url:o.YU,data:function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach(function(t){var n,o;n=t,o=r[t],(n=function(e){var t=function(e,t){if("object"!=T(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=T(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==T(t)?t:t+""}(n))in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({fields:"id, image_urls, image_sizes"},void 0!==h&&{page_size:h})},noCache:!0}),C=O.data,I=O.isFetching,E=O.fetchMore,G=O.isAtEnd,U=O.isLoaded,B=(0,n.useMemo)(function(){return null!=C?C:[]},[C]),D=(t=(0,y.o)().logContextEvent,u=(a=function(e){if(Array.isArray(e))return e}(r=(0,n.useState)(new Set))||function(e,t){var r=null==e?null:"u">typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,l=!1;try{for(i=(r=r.call(e)).next;!(c=(n=i.call(r)).done)&&(u.push(n.value),2!==u.length);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(r,0)||function(e,t){if(e){if("string"==typeof e)return A(e,2);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?A(e,2):void 0}}(r,0)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],c=a[1],l=(0,n.useRef)(new Set),f=(0,n.useRef)(!1),(0,n.useEffect)(function(){l.current=u},[u]),(0,j.A)(function(){var e=function(){if(!f.current&&0!==l.current.size){f.current=!0;var e,r=Array.from(l.current);(e=_().m(function e(){return _().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,(0,w.A)({url:o.YU,method:"DELETE",data:{lens_history_ids:r}});case 1:r.forEach(function(){t({event_type:15657,view_parameter:o.Gj,view_type:o.rm})}),e.n=3;break;case 2:e.p=2,e.v;case 3:return e.a(2)}},e,null,[[0,2]])}),function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){P(i,n,o,a,u,"next",e)}function u(e){P(i,n,o,a,u,"throw",e)}a(void 0)})})()}},r=function(){return e()};return window.addEventListener("beforeunload",r),function(){e(),window.removeEventListener("beforeunload",r)}}),{deletedIds:u,onDeleted:(0,n.useCallback)(function(e){c(function(t){return new Set(t).add(e)}),f.current=!1},[]),onUndoDelete:(0,n.useCallback)(function(e){c(function(t){var r=new Set(t);return r.delete(e),r}),f.current=!1},[])}),z=D.deletedIds,F=D.onDeleted,R=D.onUndoDelete,L=(0,n.useCallback)(function(e){var t=e.id,r=function(e){var t=e.image_urls,r=e.image_sizes;if(!t||!r)return null;var n=i.find(function(e){return t[e]&&r[e]});if(!n)return null;var o=t[n],a=r[n];if(!o||!a||"string"!=typeof o)return null;var u=a.height,c=a.width;return"number"!=typeof u||"number"!=typeof c||0===c||0===u?null:{src:o,height:u,width:c}}(e);if(!r||!t)return null;var n=r.height,o=r.width,a=r.src,u=z.has(t);return(0,s.jsx)(S,{buttonPadding:d,height:p,hideSave:v,id:t,imageHeight:n,imageWidth:o,isDeleted:u,onDeleted:F,onUndoDelete:R,src:a,viewParameter:b,viewType:m,width:g})},[d,z,p,v,F,R,b,m,g]);return{items:B,isFetching:I,fetchMore:E,isAtEnd:G,isLoaded:U,deletedIds:z,renderItem:L}}},30389(e,t,r){r.d(t,{A:function(){return N}});var n=r(157203),o=r(460657),i=r(946368),a=r(948828),u=r(217969),c=r(629342),l=r(879667);function s(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"u">typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return f(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?f(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function d(e){var t=e.anchorRef,r=e.board,f=e.onBoardSelect,d=e.onDismiss,p=e.popoverId,v=e.urlPinInfo,y=s((0,n.useState)(!1),2),h=y[0],b=y[1],m=s((0,n.useState)(""),2),g=m[0],S=m[1],w=(0,n.useCallback)(function(e){f({id:e.id,name:e.name,url:e.url}),d()},[f,d]),j=(0,n.useCallback)(function(e){if(e.boardId){var t=e.boardId,r=e.title,n=e.url;f({id:t,name:null!=r?r:void 0,url:null!=n?n:void 0}),d()}},[f,d]),_=(0,n.useCallback)(function(e){var t;S(null!=(t=null==e?void 0:e.title)?t:""),b(!0)},[]),O=(0,n.useCallback)(function(){b(!1),d()},[d]);return(0,l.jsx)(o.Wd,{zIndex:new o.K5([i.B4]),children:h?(0,l.jsx)(u.A,{boardCreateSource:"board_picker",images:[{url:v.imageUrl,name:""}],initialValues:{boardName:g},onBoardCreate:w,onClose:O}):(0,l.jsx)(o.AM,{anchor:t.current,id:p,idealDirection:"down",onDismiss:d,positionRelativeToAnchor:!1,size:"xl",children:(0,l.jsx)(a.A,{children:(0,l.jsx)(c.cC,{displayShortlistMostRecentBoard:!0,onBoardCreate:_,onItemChosen:j,selectedItem:r,showCreateBoardButton:!0,showFlyoutSaveButton:!1,showSaveToProfile:!0})})})})}var p=r(910623),v=r(752411),y=r(778443),h=r(370714),b=r(481989),m=r(898167);function g(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=Object.create((n&&n.prototype instanceof u?n:u).prototype);return S(c,"_invoke",function(r,n,o){var i,u,c,l=0,s=o||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return i=t,u=0,c=e,d.n=r,a}};function p(r,n){for(u=r,c=n,t=0;!f&&l&&!o&&t<s.length;t++){var o,i=s[t],p=d.p,v=i[2];r>3?(o=v===n)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=r<2&&p<i[1])?(u=0,d.v=n,d.n=i[1]):p<v&&(o=r<3||i[0]>n||n>v)&&(i[4]=r,i[5]=n,d.n=v,u=0))}if(o||r>1)return a;throw f=!0,n}return function(o,s,v){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,v),u=s,c=v;(t=u<2?e:c)||!f;){i||(u?u<3?(u>1&&(d.n=-1),p(u,c)):d.n=c:d.v=c);try{if(l=2,i){if(u||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,u<2&&(u=0)}else 1===u&&(t=i.return)&&t.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=e}else if((t=(f=d.n<0)?c:r.call(n,d))!==a)break}catch(t){i=e,u=1,c=t}finally{l=1}}return{value:t,done:f}}}(r,o,i),!0),c}var a={};function u(){}function c(){}function l(){}t=Object.getPrototypeOf;var s=l.prototype=u.prototype=Object.create([][n]?t(t([][n]())):(S(t={},n,function(){return this}),t));function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,S(e,o,"GeneratorFunction")),e.prototype=Object.create(s),e}return c.prototype=l,S(s,"constructor",l),S(l,"constructor",c),c.displayName="GeneratorFunction",S(l,o,"GeneratorFunction"),S(s),S(s,o,"Generator"),S(s,n,function(){return this}),S(s,"toString",function(){return"[object Generator]"}),(g=function(){return{w:i,m:f}})()}function S(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}(S=function(e,t,r,n){function i(t,r){S(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(i("next",0),i("throw",1),i("return",2))})(e,t,r,n)}function w(e,t,r,n,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void r(e)}u.done?t(c):Promise.resolve(c).then(n,o)}function j(e){return function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){w(i,n,o,a,u,"next",e)}function u(e){w(i,n,o,a,u,"throw",e)}a(void 0)})}}function _(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"u">typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,l=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==t);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return O(e,t);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?O(e,t):void 0}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var P=r(106386),A=r(891546),x=r(241358);function T(e){return(T="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach(function(t){var n,o;n=t,o=r[t],(n=function(e){var t=function(e,t){if("object"!=T(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=T(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==T(t)?t:t+""}(n))in e?Object.defineProperty(e,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[n]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function I(e){var t=e.board,r=e.onSaveComplete,n=e.urlPinInfo;return(0,l.jsx)(x.a,{action:"create",description:"",method:"lens",pinKey:null,setCompletionPromise:r,shuffleAssetKey:null,urlPinInfo:n,children:function(e){var r=e.handleSaveToBoard;return(0,l.jsx)(E,{board:t,handleSaveToBoard:r})}})}function E(e){var t=e.board,r=e.handleSaveToBoard;return(0,A.A)(function(){r(C(C({},t),{},{type:"board"}))}),null}function G(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=Object.create((n&&n.prototype instanceof u?n:u).prototype);return U(c,"_invoke",function(r,n,o){var i,u,c,l=0,s=o||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return i=t,u=0,c=e,d.n=r,a}};function p(r,n){for(u=r,c=n,t=0;!f&&l&&!o&&t<s.length;t++){var o,i=s[t],p=d.p,v=i[2];r>3?(o=v===n)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=r<2&&p<i[1])?(u=0,d.v=n,d.n=i[1]):p<v&&(o=r<3||i[0]>n||n>v)&&(i[4]=r,i[5]=n,d.n=v,u=0))}if(o||r>1)return a;throw f=!0,n}return function(o,s,v){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,v),u=s,c=v;(t=u<2?e:c)||!f;){i||(u?u<3?(u>1&&(d.n=-1),p(u,c)):d.n=c:d.v=c);try{if(l=2,i){if(u||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,u<2&&(u=0)}else 1===u&&(t=i.return)&&t.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=e}else if((t=(f=d.n<0)?c:r.call(n,d))!==a)break}catch(t){i=e,u=1,c=t}finally{l=1}}return{value:t,done:f}}}(r,o,i),!0),c}var a={};function u(){}function c(){}function l(){}t=Object.getPrototypeOf;var s=l.prototype=u.prototype=Object.create([][n]?t(t([][n]())):(U(t={},n,function(){return this}),t));function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,U(e,o,"GeneratorFunction")),e.prototype=Object.create(s),e}return c.prototype=l,U(s,"constructor",l),U(l,"constructor",c),c.displayName="GeneratorFunction",U(l,o,"GeneratorFunction"),U(s),U(s,o,"Generator"),U(s,n,function(){return this}),U(s,"toString",function(){return"[object Generator]"}),(G=function(){return{w:i,m:f}})()}function U(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}(U=function(e,t,r,n){function i(t,r){U(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(i("next",0),i("throw",1),i("return",2))})(e,t,r,n)}function B(e,t,r,n,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void r(e)}u.done?t(c):Promise.resolve(c).then(n,o)}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var z=r(869650);function F(){var e,t,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",o=r.toStringTag||"@@toStringTag";function i(r,n,o,i){var c=Object.create((n&&n.prototype instanceof u?n:u).prototype);return R(c,"_invoke",function(r,n,o){var i,u,c,l=0,s=o||[],f=!1,d={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,r){return i=t,u=0,c=e,d.n=r,a}};function p(r,n){for(u=r,c=n,t=0;!f&&l&&!o&&t<s.length;t++){var o,i=s[t],p=d.p,v=i[2];r>3?(o=v===n)&&(c=i[(u=i[4])?5:(u=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=r<2&&p<i[1])?(u=0,d.v=n,d.n=i[1]):p<v&&(o=r<3||i[0]>n||n>v)&&(i[4]=r,i[5]=n,d.n=v,u=0))}if(o||r>1)return a;throw f=!0,n}return function(o,s,v){if(l>1)throw TypeError("Generator is already running");for(f&&1===s&&p(s,v),u=s,c=v;(t=u<2?e:c)||!f;){i||(u?u<3?(u>1&&(d.n=-1),p(u,c)):d.n=c:d.v=c);try{if(l=2,i){if(u||(o="next"),t=i[o]){if(!(t=t.call(i,c)))throw TypeError("iterator result is not an object");if(!t.done)return t;c=t.value,u<2&&(u=0)}else 1===u&&(t=i.return)&&t.call(i),u<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),u=1);i=e}else if((t=(f=d.n<0)?c:r.call(n,d))!==a)break}catch(t){i=e,u=1,c=t}finally{l=1}}return{value:t,done:f}}}(r,o,i),!0),c}var a={};function u(){}function c(){}function l(){}t=Object.getPrototypeOf;var s=l.prototype=u.prototype=Object.create([][n]?t(t([][n]())):(R(t={},n,function(){return this}),t));function f(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,l):(e.__proto__=l,R(e,o,"GeneratorFunction")),e.prototype=Object.create(s),e}return c.prototype=l,R(s,"constructor",l),R(l,"constructor",c),c.displayName="GeneratorFunction",R(l,o,"GeneratorFunction"),R(s),R(s,o,"Generator"),R(s,n,function(){return this}),R(s,"toString",function(){return"[object Generator]"}),(F=function(){return{w:i,m:f}})()}function R(e,t,r,n){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}(R=function(e,t,r,n){function i(t,r){R(e,t,function(e){return this._invoke(t,r,e)})}t?o?o(e,t,{value:r,enumerable:!n,configurable:!n,writable:!n}):e[t]=r:(i("next",0),i("throw",1),i("return",2))})(e,t,r,n)}function L(e,t,r,n,o,i,a){try{var u=e[i](a),c=u.value}catch(e){return void r(e)}u.done?t(c):Promise.resolve(c).then(n,o)}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function N(e){var t,r,i,a,u,c,s,f,S,w,O,A,x,T,k,C,E,U,R,N,K,H,W,Y,$,J,V,q,Q,Z,X,ee,et,er,en,eo,ei,ea,eu,ec,el,es,ef,ed,ep,ev=e.imageUrl,ey=e.saveButtonOnly,eh=void 0!==ey&&ey,eb=(0,n.useId)(),em=(0,n.useRef)(null),eg=(0,n.useRef)(null),eS=eh?em:eg,ew=function(e){if(Array.isArray(e))return e}(ef=(0,n.useState)(!1))||function(e,t){var r=null==e?null:"u">typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,l=!1;try{for(i=(r=r.call(e)).next;!(c=(n=i.call(r)).done)&&(u.push(n.value),2!==u.length);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(ef,0)||function(e,t){if(e){if("string"==typeof e)return M(e,2);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?M(e,2):void 0}}(ef,0)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),ej=ew[0],e_=ew[1],eO=(ee={description:"",imageUrl:X=({imageUrl:ev}).imageUrl,link:""},et=function(){var e=(0,P.d4)(function(e){return e.mostRecentBoard});if(e)return{id:e.id,name:e.name,url:e.url}}(),en=(er=(r=(0,h.A)(),i=(0,b.CG)(),u=(a=(0,p.S)()).getSavedImageState,c=a.setSavedImageState,s=a.clearSavedImageState,f=u(X),w=(S=_((0,n.useState)(!!f),2))[0],O=S[1],x=(A=_((0,n.useState)(null!=(t=null==f?void 0:f.pinId)?t:null),2))[0],T=A[1],C=(k=_((0,n.useState)(null==f?void 0:f.board),2))[0],E=k[1],R=(0,n.useCallback)((U=j(g().m(function e(t,n){var o;return g().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,(0,v.A)({url:"/v3/pins/{pin}/",urlParams:{pin:t},method:"DELETE"});case 1:O(!1),T(null),E(void 0),s(X),o=n?r._('Removed from your board!', 'LensBetterSave.RemovedFromBoard', 'Toast message when pin is removed from board'):r._('Pin removed!', 'LensBetterSave.PinRemoved', 'Toast message when boardless pin is removed'),i.showToast(function(e){var t=e.hideToast;return(0,l.jsx)(y.A,{dataTestId:"lens-better-save-removed-toast",onHide:t,text:o})});case 2:return e.a(2)}},e)})),function(e,t){return U.apply(this,arguments)}),[s,r,X,i]),N=(0,n.useCallback)(j(g().m(function e(){return g().w(function(e){for(;;)switch(e.n){case 0:if(x){e.n=1;break}return e.a(2);case 1:return e.n=2,R(x,!!(null!=C&&C.id));case 2:return e.a(2)}},e)})),[x,null==C?void 0:C.id,R]),K=(0,n.useCallback)(function(e){O(!0),E(e)},[]),{isSaved:w,savedBoard:C,handleBoardSaveComplete:(0,n.useCallback)((H=j(g().m(function e(t){var r,n,o,a,u,s,f;return g().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,t.promise;case 1:n=(r=e.v).id,f={id:a=(o=r.board).id,name:u=o.name,url:s=o.url},O(!0),T(n),E(f),c(X,{pinId:n,board:f}),i.showToast(function(e){var t=e.hideToast;return(0,l.jsx)(m.A,{boardName:u,boardUrl:s,onHide:t,onUndo:j(g().m(function e(){return g().w(function(e){for(;;)switch(e.n){case 0:return t(),e.n=1,R(n,!!a);case 1:return e.a(2)}},e)})),pinImageUrl:X})});case 2:return e.a(2)}},e)})),function(e){return H.apply(this,arguments)}),[X,c,i,R]),handleUnsave:N,setOptimisticSave:K})).isSaved,eo=er.savedBoard,ei=er.handleBoardSaveComplete,ea=er.handleUnsave,eu=er.setOptimisticSave,el=(ec=(Y=(W={urlPinInfo:ee,onBoardSaveComplete:ei}).urlPinInfo,$=W.onBoardSaveComplete,q=(V=function(e){if(Array.isArray(e))return e}(J=(0,n.useState)(null))||function(e,t){var r=null==e?null:"u">typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,l=!1;try{for(i=(r=r.call(e)).next;!(c=(n=i.call(r)).done)&&(u.push(n.value),2!==u.length);c=!0);}catch(e){l=!0,o=e}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(J,0)||function(e,t){if(e){if("string"==typeof e)return D(e,2);var r=({}).toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?D(e,2):void 0}}(J,0)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],Q=V[1],Z=(0,n.useCallback)(function(){var e,t;return q?(0,l.jsx)(I,{board:q,onSaveComplete:(e=G().m(function e(t){return G().w(function(e){for(;;)switch(e.n){case 0:return e.n=1,$(t);case 1:Q(null);case 2:return e.a(2)}},e)}),t=function(){var t=this,r=arguments;return new Promise(function(n,o){var i=e.apply(t,r);function a(e){B(i,n,o,a,u,"next",e)}function u(e){B(i,n,o,a,u,"throw",e)}a(void 0)})},function(e){return t.apply(this,arguments)}),urlPinInfo:Y}):null},[q,$,Y]),{setPendingBoard:Q,renderPendingSave:Z})).setPendingBoard,es=ec.renderPendingSave,{isSaved:en,board:null!=eo?eo:et,urlPinInfo:ee,saveImageToBoard:(0,n.useCallback)(function(e){eu(e),el(e)},[eu,el]),handleUnsave:ea,renderPendingSave:es}),eP=eO.isSaved,eA=eO.board,ex=eO.urlPinInfo,eT=eO.saveImageToBoard,ek=eO.handleUnsave,eC=eO.renderPendingSave,eI=(0,n.useCallback)(function(e){(e.stopPropagation(),eh&&eP)?ek():e_(function(e){return!e})},[eh,eP,ek]),eE=(0,n.useCallback)((ed=F().m(function e(t){return F().w(function(e){for(;;)switch(e.n){case 0:if(t.stopPropagation(),!eP){e.n=1;break}return ek(),e.a(2);case 1:if(!(!(null!=eA&&eA.id)||eh)){e.n=2;break}return e_(!0),e.a(2);case 2:eT(eA);case 3:return e.a(2)}},e)}),ep=function(){var e=this,t=arguments;return new Promise(function(r,n){var o=ed.apply(e,t);function i(e){L(o,r,n,i,a,"next",e)}function a(e){L(o,r,n,i,a,"throw",e)}i(void 0)})},function(e){return ep.apply(this,arguments)}),[eA,eh,eP,ek,eT]);return(0,l.jsxs)(o.az,{ref:em,"data-test-id":"lens-better-save",width:"100%",children:[(0,l.jsx)(z.A,{accessibilityControls:eb,accessibilityExpanded:ej,accessibilityHaspopup:!0,dropdownRef:eg,hideDropdown:eh,isSaved:eP,onBoardDropdownClick:eI,onSaveClick:eE,promotedIsLeadAd:!1,selectedTitle:null==eA?void 0:eA.name,showBoardFlyout:ej,unselectedText:"Select",variant:"pin"}),ej&&(0,l.jsx)(d,{anchorRef:eS,board:eA,onBoardSelect:eT,onDismiss:function(){return e_(!1)},popoverId:eb,urlPinInfo:ex}),eC()]})}},946368(e,t,r){r.d(t,{B4:function(){return p},CR:function(){return s},Dj:function(){return m},Et:function(){return b},Gj:function(){return c},J8:function(){return d},SK:function(){return a},SY:function(){return l},UQ:function(){return g},WK:function(){return h},YU:function(){return i},b0:function(){return w},cr:function(){return S},g0:function(){return y},hU:function(){return j},nb:function(){return v},qm:function(){return f},rm:function(){return u}});var n=r(460657),o=r(598269),i="/v3/visual_search/lens/history/",a="/upload-lens-image-history/",u=119,c=4054,l=15075,s=119,f=150,d=540,p=new n.K5([o.Bf]),v="CAMERA_GALLERY",y="image/jpeg",h=".jpg",b=.8,m=1200,g="/v3/visual_search/lens/upload/",S="IMAGE_URL",w="/v3/visual_search/lens/search/",j="/upload-lens-image/"}}]);