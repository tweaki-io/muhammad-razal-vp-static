"use strict";(self.legacyJsonp=self.legacyJsonp||[]).push([["65746"],{906635(e,t,n){n.r(t);var r,o={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PinSaveRequest_pin",selections:[{alias:"images_orig",args:[{kind:"Literal",name:"spec",value:"orig"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:r=[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"orig")'},{alias:"images_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:r,storageKey:'images(spec:"236x")'},{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"title",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isPromoted",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"promotedIsRemovable",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackingParams",storageKey:null},{kind:"ClientExtension",selections:[{alias:null,args:null,kind:"ScalarField",name:"__id",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageUrl",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"imageBase64",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"mediaUploadId",storageKey:null}]}],type:"Pin",abstractKey:null};o.hash="64132b88edd48497e63c9ad85ae5ab66",t.default=o},300074(e,t,n){n.r(t);var r={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"PinSaveRequest_shuffle_asset",selections:[{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],type:"ShuffleAsset",abstractKey:null};r.hash="58c24e25a76e7a1c4533f3b07f490517",t.default=r},292878(e,t,n){n.d(t,{A:function(){return r}});function r(e,t){if(!t)return e;var n=new RegExp(/http(s?):/);if(!n.test(e)){var r=n.exec(t);r&&r.length&&(e=r[0]+e)}return e}},383176(e,t,n){n.d(t,{P:function(){return o},y:function(){return i}});var r=(0,n(4513).A)("PinCreateDeleteContext"),o=r.Provider,i=r.getMaybe},869650(e,t,n){n.d(t,{A:function(){return v}});var r=n(157203),o=n(460657),i=n(186122),a=n(370714),l=n(361268),s=n(659323),c=n(879667);function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach(function(t){var r,o;r=t,o=n[t],(r=function(e){var t=function(e,t){if("object"!=u(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=u(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==u(t)?t:t+""}(r))in e?Object.defineProperty(e,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[r]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function v(e){var t,n=e.accessibilityControls,u=e.accessibilityExpanded,d=e.accessibilityHaspopup,v=e.clientTrackingParams,_=e.dropdownRef,m=e.hideDropdown,b=void 0!==m&&m,h=e.isSaved,y=e.onBoardDropdownClick,g=e.onSaveClick,P=e.promotedIsLeadAd,S=e.renderPinSaveTooltip,w=e.selectedItem,A=e.selectedTitle,O=e.showBoardFlyout,T=e.showPromoteBanner,j=e.unselectedText,k=e.variant,C=e.viewParameter,x=e.viewType,I=e.surface,B=function(e){if(Array.isArray(e))return e}(t=(0,r.useState)(!1))||function(e,t){var n=null==e?null:"u">typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,a,l=[],s=!0,c=!1;try{for(i=(n=n.call(e)).next;!(s=(r=i.call(n)).done)&&(l.push(r.value),2!==l.length);s=!0);}catch(e){c=!0,o=e}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw o}}return l}}(t,0)||function(e,t){if(e){if("string"==typeof e)return p(e,2);var n=({}).toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,2):void 0}}(t,0)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),z=B[0],E=B[1],U=(0,a.A)(),R=(0,r.useRef)(null),D=(0,s._G)().closeupWithinMasonryEnabled,N=(0,i.o)().logContextEvent;(0,r.useEffect)(function(){z&&E(!1)},[z]);var F=(0,r.useEffectEvent)(function(){N(f(f(f({event_type:13},x?{view_type:x}:Object.freeze({})),C?{view_parameter:C}:Object.freeze({})),{},{component:13282,element:14348,object_id_str:null==w?void 0:w.boardId,clientTrackingParams:v,aux_data:{is_profile_save:(null==w?void 0:w.type)==="boardless"}}))});(0,r.useEffect)(function(){w&&(null==w?void 0:w.type)==="boardless"&&F()},[w]);var K=A||j,L="closeup"===k,M="media-viewer"===k,H="comparison"===k,J="VideoCarouselModule"===I,G=(0,r.useMemo)(function(){return H?"inverse":M?O?"inverse":"default":O||!L?"light":"default"},[L,O,M,H]),V=(0,r.useCallback)(function(e){y(e.event)},[y]),W=L?"transparent":"transparentInverse";W=M?"tertiarySemiTransparent":W,W=H?"transparentInverse":W;var $=h?U._('Saved', 'PinBetterSave.BoardSelection.SavedButton', 'BetterSave Saved label'):U._('Save', 'PinBetterSave.BoardSelection.SaveButton', 'BetterSave Save label');return(0,c.jsxs)(o.az,{alignItems:M?"start":"center",dangerouslySetInlineStyle:{__style:{gap:"4px"}},display:"flex",paddingX:D?0:void 0,width:"100%",children:[!b&&(0,c.jsx)(o.az,{"data-test-id":A?"board-selection-item-selected":"board-selection-placeholder",flex:"grow",width:"100%",children:(0,c.jsx)(o.$n,{ref:_,accessibilityControls:n,accessibilityExpanded:u,accessibilityHaspopup:d,accessibilityLabel:(0,l.$)(U._('Select a board to save to: {{ boardName }}', 'PinBetterSave.BoardSelection.DropdownIcon', 'Accessibility label used to prompt the user to select the board where the Pin will be saved. boardName: The name of the board'),{boardName:K}),color:W,dataTestId:"PinBetterSaveDropdown",iconEnd:"chevron-down",onClick:V,selected:O,size:J?"sm":"lg",text:(0,c.jsx)(o.KJ,{color:G,lineClamp:1,overflow:"breakAll",size:J?"100":"300",weight:"bold",children:K})})}),(0,c.jsx)(o.az,{alignSelf:L?"center":"start","data-test-id":"PinBetterSaveButton",flex:"none",marginStart:"auto",children:(0,c.jsx)(o.PF,{ref:R,color:P||L&&void 0!==T&&T?"secondary":"primary",onClick:function(e){var t=e.event;b?y(t):g(t)},selected:h,size:J?"sm":"lg",text:$})}),!!S&&!!R.current&&L&&S(R.current)]})}},898167(e,t,n){n.d(t,{A:function(){return c}});var r=n(460657),o=n(186122),i=n(778443),a=n(370714),l=n(361268),s=n(879667);function c(e){var t,n=e.boardName,c=e.boardUrl,u=e.isBoardlessPin,d=e.isFromPinBuilder,f=e.hasNewPin,p=e.onChangeButtonClick,v=e.onVisitButtonClick,_=e.onHide,m=e.onUndo,b=e.pinImageUrl,h=(0,a.A)(),y=(0,o.o)().logContextEvent;d?t={accessibilityLabel:h._('Visit Pin', 'PostSavedPinToast.a11yVisitButton', 'Accessibility label for Visit Pin saved from PinBuilder'),label:h._('Visit', 'PostSavedPinToast.VisitButton', 'Visit Pin saved from PinBuilder'),size:"lg",onClick:void 0===v?function(){}:v}:(p||m)&&(t={accessibilityLabel:f&&u&&p?h._('Change Pin destination', 'PostSavedPinToast.a11yChangeButton', 'Change saved pin to a different destination'):h._('Undo Saved Pin', 'PostSavedPinToast.a11yUndoButton', 'Undo Saved Pin'),label:f&&u&&p?h._('Change', 'PostSavedPinToast.ChangeButton', 'Change saved pin to a different destination'):h._('Undo', 'PostSavedPinToast.UndoButton', 'Undo Saved Pin'),size:"lg",onClick:f&&u&&p?function(){return p()}:m});var g=function(){f&&u&&p&&y({event_type:101,component:14409})};return(0,s.jsx)(i.A,{duration:u?6e3:3e3,imageUrl:b,onHide:_,primaryAction:t,text:(0,s.jsx)(r.KJ,{overflow:"normal",size:"200",children:(0,l.$w)({text:h._('Saved to <a id="1">{{ boardName }}</a>', 'PostSavedPinToast.SavedToBoardToast.Message', 'Saved to label for better save. boardName: url to saved board'),markers:{boardName:null!=n?n:""},jsxReplacements:{1:function(e){var t=e.innerHtmlStrings;return(0,s.jsx)(r.N_,{display:"block",href:u?"/me/":null!=c?c:"",onClick:g,children:(0,s.jsx)(r.KJ,{lineClamp:1,size:"200",weight:"bold",children:t},"PostSavedPinToastBoardName")})}}})}),thumbnail:u?{icon:(0,s.jsx)(r.In,{accessibilityLabel:h._('Saved to profile thumbnail', 'PostSavedPinToast.thumbnail.accessibilityLabel', 'Thumbnail for saved to profile.'),color:"default",icon:"clock-history",size:24})}:void 0})}},319029(e,t,n){n.d(t,{Bt:function(){return v},Fq:function(){return m},LR:function(){return c},Wi:function(){return b},oH:function(){return _},om:function(){return p},pV:function(){return u},yX:function(){return d}});var r=n(752411),o=n(178534);function i(){var e,t,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",o=n.toStringTag||"@@toStringTag";function l(n,r,o,i){var l=Object.create((r&&r.prototype instanceof c?r:c).prototype);return a(l,"_invoke",function(n,r,o){var i,a,l,c=0,u=o||[],d=!1,f={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,n){return i=t,a=0,l=e,f.n=n,s}};function p(n,r){for(a=n,l=r,t=0;!d&&c&&!o&&t<u.length;t++){var o,i=u[t],p=f.p,v=i[2];n>3?(o=v===r)&&(l=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=e):i[0]<=p&&((o=n<2&&p<i[1])?(a=0,f.v=r,f.n=i[1]):p<v&&(o=n<3||i[0]>r||r>v)&&(i[4]=n,i[5]=r,f.n=v,a=0))}if(o||n>1)return s;throw d=!0,r}return function(o,u,v){if(c>1)throw TypeError("Generator is already running");for(d&&1===u&&p(u,v),a=u,l=v;(t=a<2?e:l)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,l)):f.n=l:f.v=l);try{if(c=2,i){if(a||(o="next"),t=i[o]){if(!(t=t.call(i,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,a<2&&(a=0)}else 1===a&&(t=i.return)&&t.call(i),a<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=e}else if((t=(d=f.n<0)?l:n.call(r,f))!==s)break}catch(t){i=e,a=1,l=t}finally{c=1}}return{value:t,done:d}}}(n,o,i),!0),l}var s={};function c(){}function u(){}function d(){}t=Object.getPrototypeOf;var f=d.prototype=c.prototype=Object.create([][r]?t(t([][r]())):(a(t={},r,function(){return this}),t));function p(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,a(e,o,"GeneratorFunction")),e.prototype=Object.create(f),e}return u.prototype=d,a(f,"constructor",d),a(d,"constructor",u),u.displayName="GeneratorFunction",a(d,o,"GeneratorFunction"),a(f),a(f,o,"Generator"),a(f,r,function(){return this}),a(f,"toString",function(){return"[object Generator]"}),(i=function(){return{w:l,m:p}})()}function a(e,t,n,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}(a=function(e,t,n,r){function i(t,n){a(e,t,function(e){return this._invoke(t,n,e)})}t?o?o(e,t,{value:n,enumerable:!r,configurable:!r,writable:!r}):e[t]=n:(i("next",0),i("throw",1),i("return",2))})(e,t,n,r)}function l(e,t,n,r,o,i,a){try{var l=e[i](a),s=l.value}catch(e){return void n(e)}l.done?t(s):Promise.resolve(s).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise(function(r,o){var i=e.apply(t,n);function a(e){l(i,r,o,a,s,"next",e)}function s(e){l(i,r,o,a,s,"throw",e)}a(void 0)})}}function c(e){return{type:"UPDATE_USER_PIN_COUNT",payload:e}}var u=function(e,t){return{type:"USER_FOLLOW",payload:{id:e,value:t}}},d=function(e,t){return{type:"USER_FOLLOWING_COUNT",payload:{id:e,following:t}}},f=function(e,t){return{type:"USER_BLOCK",payload:{id:e,value:t}}},p=function(e){var t,n=e.id,o=e.orbacSubjectId,a=e.blockSource,l=e.blockContext,c=e.logContextEvent;return t=s(i().m(function e(t){var s;return i().w(function(e){for(;;)switch(e.n){case 0:return t(f(n,!0)),e.n=1,(0,r.A)({url:"/v3/users/{blocked_user}/block/",urlParams:{blocked_user:n},method:"PUT",data:{orbac_subject_id:o,block_source:a,block_context:l}}).catch(function(){return t(f(n,!1))});case 1:return s=e.v,c({event_type:54,object_id_str:n}),e.a(2,s)}},e)})),function(e){return t.apply(this,arguments)}},v=function(e,t){var n;return n=s(i().m(function n(o){var a;return i().w(function(n){for(;;)switch(n.n){case 0:return o(f(e,!1)),n.n=1,(0,r.A)({url:"/v3/users/{blocked_user}/block/",urlParams:{blocked_user:e},method:"DELETE"}).catch(function(){return o(f(e,!0))});case 1:return a=n.v,t({event_type:55,object_id_str:e}),n.a(2,a)}},n)})),function(e){return n.apply(this,arguments)}};function _(e){return{type:"UPDATE_USER_SCHEDULED_PIN_COUNT",payload:e}}var m=function(e,t){return function(){return(0,r.A)({url:"/v3/users/state/{state}/",urlParams:{state:e},method:"PUT",data:{value:t}})}},b=function(e,t,n){return function(i,a){(0,r.A)({url:"/v3/users/me/",method:"POST"}).then(function(){n({event_type:48,object_id_str:a().session.userId}),e(),(0,o.A)()},t)}}},241358(e,t,n){n.d(t,{a:function(){return $}});var r,o,i=n(157203),a=n(106386);n(745917);var l=n(620162),s=n(867076),c=n(586634),u=n(186122),d=n(789674),f=n(365506),p=n(956804),v=n(778443),_=n(837855),m=n(816858),b=n(993974),h=n(370714),y=n(175795),g=n(481989),P=n(292878),S=n(332540),w=n(856794),A=n(119191),O=n(383176),T=n(134449),j=n(850132),k=n(319029),C=n(460657),x=n(361268),I=n(270912),B=n(879667),z=function(e,t,n){var r;return n?(0,I.A)(e._('Saved to {{sectionName}} in {{boardName}}', 'Toast for successfully saving to a section within a board', 'Toast for successfully saving to a section within a board'),{sectionName:null!=(r=n.title)?r:"",boardName:null!=t?t:""}):(0,B.jsx)(C.KJ,{children:(0,x.$w)({text:e._('Saved to <strong id="1">{{ boardName }}</strong>', 'PinToBoard.Lib.SavedToBoardToast.Message', 'Saved to label for better save. boardName: url to saved board'),markers:{boardName:null!=t?t:""},jsxReplacements:{1:function(e){var t=e.innerHtmlStrings;return(0,B.jsx)(C.KJ,{weight:"bold",children:t})}}})})},E=n(698575),U=["pinKey","shuffleAssetKey"];function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function D(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function N(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?D(Object(n),!0).forEach(function(t){M(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function F(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(F=function(){return!!e})()}function K(e){return(K=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e,t){return(L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function M(e,t,n){return(t=H(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function H(e){var t=function(e,t){if("object"!=R(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=R(r))return r;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==R(t)?t:t+""}var J=/#[^(\-\\.\s#,\/$%\^&\*;:{}=\`~()\[\]@|<>â€¦)]+/gi,G=(void 0!==r||(r=n(906635)).hash&&"64132b88edd48497e63c9ad85ae5ab66"!==r.hash&&console.error("The definition of 'PinSaveRequest_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),r),V=(void 0!==o||(o=n(300074)).hash&&"58c24e25a76e7a1c4533f3b07f490517"!==o.hash&&console.error("The definition of 'PinSaveRequest_shuffle_asset' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o),W=function(e){var t;function n(){var e,t;if(!(this instanceof n))throw TypeError("Cannot call a class as a function");for(var r,o,i=arguments.length,a=Array(i),l=0;l<i;l++)a[l]=arguments[l];return e=n,t=[].concat(a),e=K(e),M(o=function(e,t){if(t&&("object"==R(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(this,F()?Reflect.construct(e,t||[],K(this).constructor):e.apply(this,t)),"state",{boardSavedTo:null,displaySuccessAnimation:!1,newPin:null,modalTitle:o.getModalTitle(o.props.showCreate,!!o.props.boardWithSection),pinDescription:o.props.pin&&o.props.pin.description||(null==(r=o.props.urlPinInfo)?void 0:r.description)||"",resolve:void 0,sharing:{facebook:!1,twitter:!1}}),M(o,"unmounted",!1),M(o,"setModalTitle",function(e){return o.safeSetState({modalTitle:e})}),M(o,"updateDescription",function(e){o.safeSetState({pinDescription:e})}),M(o,"close",function(){var e=o.props.onClose;e&&e(),o.props.logContextEvent({event_type:2502,component:5,element:610})}),M(o,"safeSetState",function(e,t){o.unmounted?t&&t():o.setState(e,t)}),M(o,"getPinResource",function(e,t,n){var r,i,a,l,u=o.props,d=u.color,f=u.clientTrackingParams,p=u.currentHistoryStack,v=u.pin,_=u.method,m=u.guid,b=u.additionalCreateFields,h=u.advertiser_id,y=u.urlPinInfo,g=u.shuffleAsset,S=u.viewerUserId,w=null!=v&&v.entityId?"RepinResource":"PinResource",O=(null==v?void 0:v.imageUrl)||(null==y?void 0:y.imageUrl),T=(null==v?void 0:v.link)||(null==y?void 0:y.link),j=!(null!=v&&v.entityId)&&O?(0,P.A)(O,T):(null==v||null==(r=v.images_orig)?void 0:r.url)||"",k=(0,c.A)(null!=p?p:[],!!S).trafficSource,C=N(N(N({},b),{},{board_id:t||"",color:d||"",clientTrackingParams:(0,A.A)(f,null==v?void 0:v.trackingParams),description:o.state.pinDescription,guid:m||"",link:T,image_base64:null!=(i=null==v?void 0:v.imageBase64)?i:void 0,image_url:j,is_buyable_pin:!1,is_removable:null!=(a=null==v?void 0:v.promotedIsRemovable)?a:void 0,media_upload_id:null!=(l=null==v?void 0:v.mediaUploadId)?l:void 0,method:_||"",pin_id:(null==v?void 0:v.entityId)||"",section:n,title:(null==v?void 0:v.title)||"",aux_data:{source:k}},h?{advertiser_id:h}:Object.freeze({})),g?{shuffle_asset:g.entityId}:{});if(!e){var x=o.state.sharing,I=x.facebook,B=x.twitter;C.share_facebook=I,C.share_twitter=B}return s.A.create(w,C)}),M(o,"triggerPubSubs",function(e){o.props.onPinCreate&&o.props.onPinCreate({boardId:e.board.id,pinId:e.id})}),M(o,"makeCancelablePromise",function(e){var t=!1;return{promise:new Promise(function(n,r){e.then(function(e){return t?r({isCanceled:!0}):n(e)}),e.catch(function(e){return t?r({isCanceled:!0}):r(e)})}),cancel:function(){t=!0}}}),M(o,"handleLogToastClick",function(){o.props.logContextEvent({event_type:101,component:20,view_type:52})}),M(o,"showBoardSavedToast",function(e,t){var n=o.props,r=n.toastManagerContext,i=n.i18n;r.showToast(function(n){var r,a,l,s=n.hideToast;return(0,B.jsx)(v.A,{duration:E.e,href:t?"".concat(null!=(r=e.url)?r:"").concat(null!=(a=t.slug)?a:""):e.url,imageUrl:null!=(l=e.image_cover_url)?l:"",onClick:o.handleLogToastClick,onHide:s,text:z(i,e.name,t)})})}),M(o,"dismissModal",function(){var e=o.state,t=e.resolve,n=e.newPin;t&&t(n)}),M(o,"handleBoardSaveSuccess",function(e,t,n,r){var i,a,l,s=o.props,c=(s.action,s.saveToBoard),u=s.dispatch,d=s.pin,f=s.setCompletionPromise,v=s.shouldShowToast,_=s.showRepinAnimation,m=s.viewerUserId,b=s.urlPinInfo;u((0,p.$O)());var h=e.resource_response.data,g=o.makeCancelablePromise(new Promise(function(e){o.triggerPubSubs(h);var i,a=o.state.pinDescription.match(J)||[];a.length>0&&o.props.logContextEvent({event_type:2,element:10273,object_id_str:null==(i=o.props.pin)?void 0:i.entityId,aux_data:{hashtags:JSON.stringify(a)}}),r?(v&&o.showBoardSavedToast(t,n),o.safeSetState({displaySuccessAnimation:!0,modalTitle:o.props.i18n._('Board created', 'Modal title after creating a new board', 'Modal title after creating a new board'),newPin:h,resolve:e})):e(h)}));!r&&null!=d&&d.entityId&&_(d.entityId),f(g),c(t),u((0,T.zY)({boardId:t.id,sectionId:n&&n.id,increment:1})),m&&(u((0,k.LR)({userId:m,increment:1})),u((0,p.$O)())),(n||!t.image_cover_url)&&(t.image_cover_url=(null==d?void 0:d.imageUrl)||(null==b?void 0:b.imageUrl)||(null==d||null==(i=d.images_236x)?void 0:i.url)||"",u((0,T.NQ)(t))),n&&u((0,y.Jt)("BoardSectionResource",{options:{field_set_key:"board_page",section_id:n.id}})),null!=d&&d.entityId&&u((0,j.J4)({id:d.entityId,nodeId:d.__id,boardId:t.id,title:null!=(a=t.name)?a:"",url:null!=(l=t.url)?l:"",localPinId:h.id}))}),M(o,"handleSaveToBoard",function(e,t,n){var r=o.props,i=r.onToggleModal,a=r.shouldShowToast,l=r.mountAfterActionPlacement;a&&!n&&(o.close(),o.showBoardSavedToast(e,t));var s="secret"===(e.privacy||""),c={board:t?t.id:e.id,state:E.J.LOADING};o.safeSetState({boardSavedTo:c},function(){o.getPinResource(s,e.id,(t||{}).id).callCreate({showError:!1}).then(function(r){var a,s;l("Save",{pin_id:null==(a=o.props.pin)?void 0:a.entityId,is_promoted:null==(s=o.props.pin)?void 0:s.isPromoted}),o.safeSetState({boardSavedTo:Object.assign(c,{state:E.J.SUCCESS})},function(){return o.handleBoardSaveSuccess(r,e,t,n)}),i&&!n&&i(!1)}).catch(function(e){o.unmounted||o.safeSetState({boardSavedTo:null}),d.A.showError(e.message_detail||e.message);var t=o.makeCancelablePromise(Promise.reject(e));o.props.setCompletionPromise(t),i&&i(!1)})})}),M(o,"handleNewBoardAnimationCompletion",function(){var e=o.props,t=e.pin,n=e.showRepinAnimation;null!=t&&t.entityId&&n(t.entityId)}),o}if("function"!=typeof e&&null!==e)throw TypeError("Super expression must either be null or a function");return n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&L(n,e),t=[{key:"getModalTitle",value:function(e,t){if(e)if(t)return this.props.i18n._('Create section', 'modal title for create section pane', 'modal title for create section pane');else return this.props.i18n._('Create board', 'Repin title for making a new board', 'Repin title for making a new board');return t?this.props.i18n._('Choose section', 'modal title for choose section', 'modal title for choose section'):this.props.i18n._('Choose board', 'Repin title for choosing a board', 'Repin title for choosing a board')}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.boardWithSection,r=t.showCreate,o=t.pin,i=t.urlPinInfo,a=t.description,l={};(o!==e.pin||i!==e.urlPinInfo||a!==e.description)&&(l.pinDescription=(null==o?void 0:o.description)||(null==i?void 0:i.description)||a||""),(r!==e.showCreate||n!==e.boardWithSection)&&(l.modalTitle=this.getModalTitle(r,!!n)),Object.keys(l).length>0&&this.safeSetState(l)}},{key:"componentWillUnmount",value:function(){this.unmounted=!0}},{key:"render",value:function(){var e=this.close,t=this.dismissModal,n=this.handleNewBoardAnimationCompletion,r=this.handleSaveToBoard,o=this.setModalTitle,i=this.updateDescription,a=this.state,l=a.boardSavedTo,s=a.displaySuccessAnimation,c=a.modalTitle,u=a.newPin,d=this.props.color;return this.props.children({boardSavedTo:l,color:d,dismissModal:t,displaySuccessAnimation:s,handleAbort:e,handleNewBoardAnimationCompletion:n,handleSaveToBoard:r,modalTitle:c,newPin:u,setModalTitle:o,updateDescription:i})}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,H(r.key),r)}}(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n}(i.Component);function $(e){var t,n=e.pinKey,r=e.shuffleAssetKey,o=function(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if(({}).hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&({}).propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}(e,U),i=(0,w.p)().saveToBoard,s=(0,u.o)().logContextEvent,c=null==(t=(0,O.y)())?void 0:t.onPinCreate,d=(0,h.A)(),p=(0,l.zy)(),v=(0,_.A)(),y=(0,g.CG)(),P=(0,a.wA)(),A=(0,S.A)().updateHeaderState,T=(0,a.d4)(function(e){var t=e.advertiser;return v.isAuth&&t&&t.owner_user_id!==v.id?t.id:void 0}),j=(0,b.qD)().previous,k=(0,f.Ts)(),C=(0,b.V)(),x=(0,m.A)(G,n),I=(0,m.A)(V,r);return(0,B.jsx)(W,N(N({},o),{},{advertiser_id:T,currentHistoryStack:C,dispatch:P,i18n:d,location:p,logContextEvent:s,mountAfterActionPlacement:k,onPinCreate:c,pin:x,previousHistory:j,saveToBoard:i,showRepinAnimation:function(e){return A({type:"showRepinAnimation",payload:e})},shuffleAsset:I,toastManagerContext:y,viewerUserId:v.isAuth?v.id:void 0}))}},698575(e,t,n){n.d(t,{J:function(){return o},e:function(){return r}});var r=4e3,o={LOADING:"loading",SUCCESS:"success"}}}]);